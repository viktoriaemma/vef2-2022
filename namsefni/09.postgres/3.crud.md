---
title: CRUD
---

## CRUD

### Vefforritun

### 칍lafur Sverrir Kjartansson, [osk@hi.is](mailto:osk@hi.is)

---

## CRUD a칧ger칧ir

* Samansafn af a칧ger칧um sem vinna me칧 kallast oft _CRUD_
  * Create (`INSERT`)
  * Read (`SELECT`)
  * Update (`UPDATE`)
  * Delete (`DELETE`)

***

D칝mi mi칧a vi칧:

```sql
CREATE TABLE public.people (
  id SERIAL PRIMARY KEY,
  name VARCHAR(64) NOT NULL UNIQUE,
  text TEXT,
  registered BOOLEAN DEFAULT FALSE,
  date TIMESTAMP WITH TIME ZONE NOT NULL
    DEFAULT CURRENT_TIMESTAMP
);
```

***

## B칝ta vi칧 t칬flu ([insert](https://www.postgresql.org/docs/current/static/sql-insert.html))

```sql
INSERT INTO people
  (name, text)
VALUES
  ('J칩n', 'Hall칩');
```

```sql
INSERT 0 1
```

***

```sql
INSERT INTO people
  (name, registered, text)
VALUES
  ('Anna', true, '')
RETURNING *;
-- RETURNING skilar okkur r칬칧 sem var칧 til
-- Getum vali칧 d치lk, sj치 a칧 ne칧an
```

```sql
 id | name | text | registered |             date             
----+------+------+------------+------------------------------
  2 | Anna |      | t          | 2022-01-29 21:02:20.59264+00
(1 row)
```

***

## Velja 칰r t칬flu ([select](https://www.postgresql.org/docs/current/static/sql-select.html))

```sql
-- * velur alla d치lka
-- Tilgreinum ekki takm칬rkun
-- f치um *allar* ra칧ir
SELECT * FROM people;
```

```sql
 id | name | text  | registered |             date              
----+------+-------+------------+-------------------------------
  1 | J칩n  | Hall칩 | f          | 2022-01-29 21:01:24.959453+00
  2 | Anna |       | t          | 2022-01-29 21:02:20.59264+00
(2 rows)
```

***
### Velja d치lka 칰r t칬flu

```sql
-- Tilgreinum n치kv칝mlega hva칧a d치lka
SELECT name, registered FROM people;
```

```sql
 name | registered
------+------------
 J칩n  | f
 Anna | t
(2 rows)
```

***
### ORDER BY

```sql
SELECT name, registered FROM people ORDER BY name; -- Ra칧a칧 eftir nafni
```

```sql
SELECT name, registered FROM people ORDER BY id; -- Ra칧a칧 eftir id
```


***
## Uppf칝ra t칬flu ([update](https://www.postgresql.org/docs/current/static/sql-update.html))

```sql
-- Notum where skilyr칧i til a칧 breyta
-- n치kv칝mri r칬칧, 치n where skilyr칧is
-- uppf칝rum vi칧 *allar* ra칧ir
UPDATE people SET name = '칍li' WHERE id = 1;
```

```sql
UPDATE 1
```

***

```sql
SELECT * FROM people;
 id | name | text  | registered |             date              
----+------+-------+------------+-------------------------------
  2 | Anna |       | t          | 2022-01-29 21:02:20.59264+00
  1 | 칍li  | Hall칩 | f          | 2022-01-29 21:01:24.959453+00
```

***

```sql
-- 츼n where skilyr칧is uppf칝rum
-- vi칧 *allar* ra칧ir
UPDATE people SET text = 'blabla';
UPDATE 2
```

***

```sql
SELECT * FROM people;
 id | name |  text  | registered |             date              
----+------+--------+------------+-------------------------------
  2 | Anna | blabla | t          | 2022-01-29 21:02:20.59264+00
  1 | 칍li  | blabla | f          | 2022-01-29 21:01:24.959453+00
(2 rows)
```

***

## Ey칧a 칰r t칬flu ([delete](https://www.postgresql.org/docs/current/static/sql-update.html))

```sql
-- Sama h칠r, notum where skilyr칧i
-- 츼n 쬰ss EY칋UM VI칋 칐LLUM F칁RSLUM 游
DELETE FROM people WHERE id = 1;
```

```sql
DELETE 1
```

***

```sql
db-test=# UPDATE people SET text = 'Bonjour!';
UPDATE 2 -- tveimur r칬칧um update-a칧
db-test=# SELECT * FROM people;
 id | name |   text   | registered |             date              
----+------+----------+------------+-------------------------------
  2 | Anna | Bonjour! | t          | 2022-03-01 17:11:46.228999+00
  1 | Emma | Bonjour! | f          | 2022-03-01 17:09:59.030038+00
(2 rows)

db-test=# DELETE FROM people WHERE id=2;
DELETE 1 -- einni r칬칧 update-a칧
db-test=# DELETE FROM people WHERE id=2;
DELETE 0 -- engri r칬칧 update-a칧
db-test=# 
```

